define("avalon-mobile",function(){function i(){avalon.config.debug&&console.log.apply(console,arguments)}function s(){return Object.create(null)}function x(){}function T(e,t){typeof e=="string"&&(e=e.match(a)||[]);var n={},r=t!==void 0?t:1;for(var i=0,s=e.length;i<s;i++)n[e[i]]=r;return n}function C(){if(window.VBArray){var e=document.documentMode;return e?e:window.XMLHttpRequest?7:6}return NaN}function A(e,t){return e=Math.floor(e)||0,e<0?Math.max(t+e,0):Math.min(e,t)}function _(e){if(e&&typeof e=="object"){var t=e.length,n=d.call(e);if(/(Array|List|Collection|Map|Arguments)\]$/.test(n))return!0;if(n==="[object Object]"&&t===t>>>0)return!0}return!1}function F(e){for(var t in e){if(!p.call(e,t))continue;var n=e[t];typeof F.plugins[t]=="function"?F.plugins[t](n):typeof F[t]=="object"?avalon.mix(F[t],n):F[t]=n}return this}function X(e){return(e+"").replace(W,"\\$&")}function Y(e,t,n){if(Array.isArray(e)){var r=e.concat();e.length=0;var i=ct(e);return i.pushArray(r),i}if(!e||e.nodeType>0||e.$id&&e.$events)return e;var o=Array.isArray(e.$skipArray)?e.$skipArray:[];o.$special=t||s();var u={};n=n||{};var a=s(),l=s(),c=[];G.forEach(function(t){delete e[t]});var h=Object.keys(e);h.forEach(function(t,r){var i=e[t];n[t]=i;if(ft(t,i,o)){a[t]=[];var s=avalon.type(i);s==="object"&&L(i.get)&&Object.keys(i).length<=2?(r=nt(t,i),c.push(r)):f.test(s)?r=rt(t,i,s,a[t],n):r=tt(t,i),l[t]=r}}),u=Object.defineProperties(u,lt(l));for(var p=0;p<h.length;p++){var d=h[p];l[d]||(u[d]=e[d])}Z(u,"$id",N()),Z(u,"$model",n),Z(u,"$events",a),Z(u,"hasOwnProperty",function(e){return e in this.$model});for(p in K)Z(u,p,K[p]);return u.$reinitialize=function(){c.forEach(function(e){delete e._value,delete e.oldArgs,e.digest=function(){e.call(u)},gt.begin({callback:function(t,n){var r=n._name;if(n!==e){var i=t.$events[r];e.vm=u,bt(i,e.digest)}}});try{e.get.call(u)}finally{gt.end()}})},u.$reinitialize(),u}function Z(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!1,configurable:!0})}function et(e){var t=Object.keys(e);for(var n=0;n<G.length;n++){var r=t.indexOf(G[n]);r!==-1&&t.splice(r,1)}return t}function tt(e,t){function n(e){var t=n._value;return arguments.length>0?(!u&&!at(e,t)&&(n.updateValue(this,e),n.notify(this,e,t)),this):(gt.collectDependency(this,n),t)}return ut(n,e),n._value=t,n}function nt(e,t){function n(t){var r=n._value,i="_value"in n;if(arguments.length>0){if(u)return this;if(typeof n.set=="function"&&n.oldArgs!==t){n.oldArgs=t;var s=this.$events,o=s[e];s[e]=[],n.set.call(this,t),s[e]=o,t=n.get.call(this),t!==r&&(n.updateValue(this,t),n.notify(this,t,r))}return this}return t=n.get.call(this),n.updateValue(this,t),i&&r!==t&&n.notify(this,t,r),t}return n.set=t.set,n.get=t.get,ut(n,e),n}function rt(e,t,n,r,i){function s(t){var r=s._value,i=s._vmodel;if(arguments.length>0){if(u)return this;if(n==="array"){var a=i,f=t,l=a.length,c=f.length;a.$lock=!0,l>c?a.splice(c,l-c):c>l&&a.push.apply(a,f.slice(l));var h=Math.min(l,c);for(var d=0;d<h;d++)a.set(d,f[d]);delete a.$lock,a._fire("set")}else if(n==="object"){var v=this.$events[e]||[],m=avalon.mix(!0,{},t);for(d in i)i.hasOwnProperty(d)&&p.call(m,d)&&(i[d]=m[d]);i=s._vmodel=Y(t),i.$events[o]=v,v.length&&v.forEach(function(e){if(!e.type)return;e.rollback&&e.rollback(),O[e.type](e,e.vmodels)})}return s.updateValue(this,i.$model),s.notify(this,this._value,r),this}return gt.collectDependency(this,s),i}ut(s,e),Array.isArray(t)?i[e]=t:i[e]=i[e]||{};var a=s._vmodel=Y(t,0,i[e]);return a.$events[o]=r,s}function it(e,t){e.$model[this._name]=this._value=t}function st(e,t){e.$model[this._name]=t}function ot(e,t,n){var r=this._name,i=e.$events[r];i&&(wt(i),K.$fire.call(e,r,t,n))}function ut(e,t){e._name=t,e.updateValue=it,e.notify=ot}function ft(e,t,n){if(L(t)||t&&t.nodeType)return!1;if(n.indexOf(e)!==-1)return!1;var r=n.$special;return e&&e.charAt(0)==="$"&&!r[e]?!1:!0}function ct(e){var t=[];t.$id=N(),t.$model=e,t.$events={},t.$events[o]=[],t._=Y({length:e.length}),t._.$watch("length",function(e,n){t.$fire("length",e,n)});for(var n in K)t[n]=K[n];return avalon.mix(t,dt),t}function ht(e,t,n,r,i,s,o){var u=this.length,a=2;while(--a){switch(e){case"add":var l=this.$model.slice(t,t+n).map(function(e){return f.test(avalon.type(e))?e.$id?e:Y(e,0,e):e});pt.apply(this,[t,0].concat(l)),this._fire("add",t,n);break;case"del":var c=this._splice(t,n);this._fire("del",t,n)}i&&(e=i,t=s,n=o,a=2,i=0)}return this._fire("index",r),this.length!==u&&(this._.length=this.length),c}function vt(e,t){var n=e.length-1;for(var r;r=e[t];t++)r.$index=t,r.$first=t===0,r.$last=t===n}function mt(e,t){var n={};for(var r=0,i=t.length;r<i;r++){n[r]=e[r];var s=t[r];s in n?(e[r]=n[s],delete n[s]):e[r]=e[s]}}function bt(e,t){if(t.oneTime)return;e&&avalon.Array.ensure(e,t)&&t.element&&(Ct(t,e),new Date-xt>444&&kt())}function wt(e){if(e&&e.length){new Date-xt>444&&typeof e[0]=="object"&&kt();var t=m.call(arguments,1);for(var n=e.length,r;r=e[--n];){var i=r.element;if(i&&i.parentNode)try{var s=r.evaluator;if(r.$repeat)r.handler.apply(r,t);else if("$repeat"in r||!s)O[r.type](r,r.vmodels);else if(r.type!=="on"){var o=s.apply(0,r.args||[]);r.handler(o,i,r)}}catch(u){console.log(u)}}}}function Nt(e,t){return!e.uuid&&!t&&(e.uuid=++Et),e.uuid}function Ct(e,t){var n=e.element;e.uuid||(n.nodeType!==1?e.uuid=e.type+Nt(n.parentNode)+"-"+ ++Et:e.uuid=e.name+"-"+Nt(n));var r=e.lists||(e.lists=[]);avalon.Array.ensure(r,t),t.$uuid=t.$uuid||N(),St[e.uuid]||(St[e.uuid]=1,St.push(e))}function kt(e){if(avalon.optimize)return;var t=St.length,n=t,r=[],i={},s={};while(e=St[--t]){var o=e.type;s[o]?s[o]++:(s[o]=1,r.push(o))}var u=!1;r.forEach(function(e){Tt[e]!==s[e]&&(i[e]=1,u=!0)}),t=n;if(u)while(e=St[--t]){if(e.element===null){St.splice(t,1);continue}if(i[e.type]&&At(e.element)){St.splice(t,1),delete St[e.uuid];var a=e.lists;for(var f=0,l;l=a[f++];)avalon.Array.remove(a,l),avalon.Array.remove(l,e);Lt(e)}}Tt=s,xt=new Date}function Lt(e){delete St[e.uuid],e.element=null,e.rollback&&e.rollback();for(var t in e)e[t]=null}function At(e){try{var t=e.parentNode.nodeType}catch(n){return!0}return e.ifRemove&&!b.contains(e.ifRemove)&&r===e.parentNode?(e.parentNode&&e.parentNode.removeChild(e),!0):e.msRetain?0:e.nodeType===1?!b.contains(e):!avalon.contains(b,e)}function Bt(e){return e.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function jt(e){return e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(/[-_][^-_]/g,function(e){return e.charAt(1).toUpperCase()})}function It(e){try{if(typeof e=="object")return e;e=e==="true"?!0:e==="false"?!1:e==="null"?null:+e+""===e?+e:Ft.test(e)?JSON.parse(e):e}catch(t){}return e}function qt(e){return e.window&&e.document?e:e.nodeType===9?e.defaultView:!1}function Vt(e,t){if(e.offsetWidth<=0){var n=getComputedStyle(e,null);if(Xt.test(n.display)){var r={node:e};for(var i in Wt)r[i]=n[i],e.style[i]=Wt[i];t.push(r)}var s=e.parentNode;s&&s.nodeType===1&&Vt(s,t)}}function $t(e){var t=e.tagName.toLowerCase();return t==="input"&&/checkbox|radio/.test(e.type)?"checked":t}function sn(e,t,n,r){var i=[],s=" = "+n+".";for(var o=e.length,u;u=e[--o];)t.hasOwnProperty(u)&&(i.push(u+s+u),r.vars.push(u),r.type==="duplex"&&(e.get=n+"."+u),e.splice(o,1));return i}function on(e){var t=[],n={};for(var r=0;r<e.length;r++){var i=e[r],s=i&&typeof i.$id=="string"?i.$id:i;n[s]||(n[s]=t.push(i))}return t}function vn(e,t){return t=t.replace(ln,"").replace(cn,function(){return"],|"}).replace(hn,function(e,t){return"["+Kt(t)}).replace(pn,function(){return'"],["'}).replace(dn,function(){return'",'})+"]","return this.filters.$filter("+e+", "+t+")"}function mn(t,n,r){var s=r.type,o=r.filters||"",u=n.map(function(e){return String(e.$id).replace(fn,"$1")})+t+s+o,a=rn(t).concat(),f=[],l=[],c=[],h="";n=on(n),r.vars=[];for(var p=0,d=n.length;p<d;p++)if(a.length){var v="vm"+e+"_"+p;l.push(v),c.push(n[p]),f.push.apply(f,sn(a,n[p],v,r))}if(!f.length&&s==="duplex")return;s!=="duplex"&&(t.indexOf("||")>-1||t.indexOf("&&")>-1)&&r.vars.forEach(function(e){var n=new RegExp("\\b"+e+"(?:\\.\\w+|\\[\\w+\\])+","ig");t=t.replace(n,function(n,r){var i=n.charAt(e.length),s=t.slice(r+n.length),o=/^\s*\(/.test(s);if(i==="."||i==="["||o){var u="var"+String(Math.random()).replace(/^0\./,"");if(o){var a=n.split(".");if(a.length>2){var l=a.pop();return f.push(u+" = "+a.join(".")),u+"."+l}return n}return f.push(u+" = "+n),u}return n})}),r.args=c,delete r.vars;var m=un.get(u);if(m){r.evaluator=m;return}h=f.join(", "),h&&(h="var "+h);if(/\S/.test(o)){if(!/text|html/.test(r.type))throw Error("ms-"+r.type+"不支持过滤器");t="\nvar ret"+e+" = "+t+";\r\n",t+=vn("ret"+e,o);try{m=Function.apply(x,l.concat("'use strict';\n"+h+t)),r.evaluator=un.put(u,function(){return m.apply(avalon,arguments)})}catch(g){i("debug: parse error,"+g.message)}a=f=l=null;return}if(s==="duplex"){var y="'use strict';\nreturn function(vvv){\n	"+h+";\n	if(!arguments.length){\n		return "+t+"\n	}\n	"+(an.test(t)?t:a.get)+"= vvv;\n} ";try{m=Function.apply(x,l.concat(y)),r.evaluator=un.put(u,m)}catch(g){i("debug: parse error,"+g.message)}a=f=l=null;return}if(s==="on"){t.indexOf("(")===-1?t+=".call(this, $event)":t=t.replace("(",".call(this,"),l.push("$event"),t="\nreturn "+t+";";var b=t.lastIndexOf("\nreturn"),w=t.slice(0,b),E=t.slice(b);t=w+"\n"+E}else t="\nreturn "+t+";";try{m=Function.apply(x,l.concat("'use strict';\n"+h+t)),r.evaluator=un.put(u,m)}catch(g){i("debug: parse error,"+g.message)}a=f=l=null}function gn(e){var t=R.test(e);if(t){var n=zn(e);return n.length===1?n[0].value:n.map(function(e){return e.expr?"("+e.value+")":Kt(e.value)}).join(" + ")}return e}function yn(e,t,n,r){e=e||"",mn(e,t,n),n.evaluator&&!r&&(n.handler=M[n.handlerName||n.type],avalon.injectBinding(n))}function wn(e,t,n){var r=setTimeout(function(){var i=e.innerHTML;clearTimeout(r),i===n?t():wn(e,t,i)})}function En(e,t){var n=e.getAttribute("avalonctrl")||t.$id;e.setAttribute("avalonctrl",n),t.$events.expr=e.tagName+'[avalonctrl="'+n+'"]'}function xn(e,t){for(var n=0,r;r=e[n++];)r.vmodels=t,O[r.type](r,t),r.evaluator&&r.element&&r.element.nodeType===1&&r.element.removeAttribute(r.name);e.length=0}function On(e,t){return e.priority-t.priority}function Mn(e,t,n){var r=!0;if(t.length){var o=e.attributes,u=[],a=[],f={},l=s();for(var c=0,h;h=o[c++];)if(h.specified)if(n=h.name.match(Cn)){var p=n[1],d=n[2]||"",v=h.value,m=h.name;if(f[m])continue;f[m]=1,Ln[p]?(d=p,p="on"):An[p]&&(p==="enabled"&&(i("warning!ms-enabled或ms-attr-enabled已经被废弃"),p="disabled",v="!("+v+")"),d=p,p="attr",m="ms-"+p+"-"+d,a.push([h.name,m,v])),l[m]=v;if(typeof O[p]=="function"){var g=v.replace(Nn,""),y=v!==g,b={type:p,param:d,element:e,name:m,value:g,oneTime:y,priority:(kn[p]||p.charCodeAt(0)*10)+(Number(d.replace(/\D/g,""))||0)};if(p==="html"||p==="text"){var w=Un(v);avalon.mix(b,w),b.filters=b.filters.replace(jn,function(){return b.type="html",b.group=1,""})}else if(p==="duplex")var E=m;else m==="ms-if-loop"&&(b.priority+=100);u.push(b),p==="widget"&&(e.msData=e.msData||l)}}if(u.length){u.sort(On),a.forEach(function(t){i("warning!请改用"+t[1]+"代替"+t[0]+"!"),e.removeAttribute(t[0]),e.setAttribute(t[1],t[2])});var S=e.type;S&&E&&l["ms-attr-value"]&&e.type==="text"&&i("warning!"+S+"控件不能同时定义ms-attr-value与"+E);for(c=0;b=u[c];c++){p=b.type;if(_n.test(p))return xn(u.slice(0,c+1),t);r&&(r=!Dn.test(p))}xn(u,t)}}r&&!bn[e.tagName]&&z.test(e.innerHTML+e.textContent)&&(Tn&&Tn(e),Pn(e,t))}function Pn(e,t){var n=avalon.slice(e.childNodes);Hn(n,t)}function Hn(e,t){for(var n=0,r;r=e[n++];)switch(r.nodeType){case 1:Bn(r,t),r.msCallback&&(r.msCallback(),r.msCallback=void 0);break;case 3:R.test(r.nodeValue)&&Wn(r,t,n)}}function Bn(e,t,n){var r=e.getAttribute("ms-skip"),i=e.getAttributeNode("ms-important"),s=e.getAttributeNode("ms-controller");if(typeof r=="string")return;if(n=i||s){var o=avalon.vmodels[n.value];if(!o)return;t=n===i?[o]:[o].concat(t),e.removeAttribute(n.name),e.classList.remove(n.name),En(e,o)}Mn(e,t)}function Un(e){if(e.indexOf("|")>0){var t=e.replace(Rn,function(e){return Array(e.length+1).join("1")}),n=t.replace(Fn,"ᄢ㍄").indexOf("|");if(n>-1)return{filters:e.slice(n),value:e.slice(0,n),expr:!0}}return{value:e,filters:"",expr:!0}}function zn(e){var t=[],n,r=0,i;do{i=e.indexOf(I,r);if(i===-1)break;n=e.slice(r,i),n&&t.push({value:n,filters:"",expr:!1}),r=i+I.length,i=e.indexOf(q,r);if(i===-1)break;n=e.slice(r,i),n&&t.push(Un(n)),r=i+q.length}while(1);return n=e.slice(r),n&&t.push({value:n,expr:!1,filters:""}),t}function Wn(e,n){var r=[],i=zn(e.data);if(i.length){for(var s=0,o;o=i[s++];){var u=t.createTextNode(o.value);o.expr&&(o.value=o.value.replace(Nn,function(){return o.oneTime=!0,""}),o.type="text",o.element=u,o.filters=o.filters.replace(jn,function(e,t,n){return o.type="html",""}),r.push(o)),w.appendChild(u)}e.parentNode.replaceChild(w,e),r.length&&xn(r,n)}}function Zn(e,n,r){var i=e.templateCache&&e.templateCache[n];if(i){var s=t.createDocumentFragment(),o;while(o=i.firstChild)s.appendChild(o);return s}return avalon.parseHTML(r)}function tr(e){return e==null?"":e}function nr(e,t,n,r){return t.param.replace(/\w+/g,function(r){var i=avalon.duplexHooks[r];i&&typeof i[n]=="function"&&(e=i[n](e,t))}),e}function sr(){for(var e=ir.length-1;e>=0;e--){var t=ir[e];t()===!1&&ir.splice(e,1)}ir.length||clearInterval(rr)}function fr(e,n,r,i){var s=e.template.cloneNode(!0),o=avalon.slice(s.childNodes);s.insertBefore(t.createComment(e.signature),s.firstChild),n.appendChild(s);var u=[r].concat(e.vmodels),a={nodes:o,vmodels:u};i.push(a)}function lr(e){var t=[],n=e.element.parentNode.childNodes;for(var r=0,i;i=n[r++];)if(i.nodeValue===e.signature)t.push(i);else if(i.nodeValue===e.signature+":end")break;return t}function cr(e,t,n){for(;;){var r=t.previousSibling;if(!r)break;r.parentNode.removeChild(r),n&&n.call(r);if(r===e)break}}function pr(){var e=Y({$key:"",$outer:{},$host:{},$val:{get:function(){return this.$host[this.$key]},set:function(e){this.$host[this.$key]=e}}},{$val:1});return e.$id=N("$proxy$with"),e}function dr(e,t,n){e=e||hr.pop(),e?e.$reinitialize():e=pr();var r=n.$repeat;return e.$key=t,e.$host=r,e.$outer=n.$outer,r.$events?e.$events.$val=r.$events[t]:e.$events={},e}function vr(e){mr(e)}function mr(e){e.forEach(function(e){wr(e,gr)}),e.length=0}function yr(e){var t={$host:[],$outer:{},$index:0,$first:!1,$last:!1,$remove:avalon.noop};t[e]={get:function(){var t=this.$events,n=t.$index;t.$index=t[e];try{return this.$host[this.$index]}finally{t.$index=n}},set:function(e){try{var t=this.$events,n=t.$index;t.$index=[],this.$host.set(this.$index,e)}finally{t.$index=n}}};var n={$last:1,$first:1,$index:1},r=Y(t,n);return r.$id=N("$proxy$each"),r}function br(e,t){var n=t.param||"el",r;for(var i=0,s=gr.length;i<s;i++){var o=gr[i];o&&o.hasOwnProperty(n)&&(r=o,gr.splice(i,1))}r||(r=yr(n));var u=t.$repeat,a=u.length-1;return r.$index=e,r.$first=e===0,r.$last=e===a,r.$host=u,r.$outer=t.$outer,r.$remove=function(){return u.removeAt(r.$index)},r}function wr(e,t){for(var n in e.$events){var r=e.$events[n];Array.isArray(r)&&(r.forEach(function(e){typeof e=="object"&&Lt(e)}),r.length=0)}e.$host=e.$outer={},t.unshift(e)>F.maxRepeatSize&&t.pop()}function Er(e,n){var r="_"+e;if(!Er[r]){var i=t.createElement(e);b.appendChild(i),y?n=getComputedStyle(i,null).display:n=i.currentStyle.display,b.removeChild(i),Er[r]=n}return Er[r]}function Ar(e,t,n,r){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var i=isFinite(+e)?+e:0,s=isFinite(+t)?Math.abs(t):3,o=r||",",u=n||".",a="",f=function(e,t){var n=Math.pow(10,t);return""+(Math.round(e*n)/n).toFixed(t)};return a=(s?f(i,s):""+Math.round(i)).split("."),a[0].length>3&&(a[0]=a[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,o)),(a[1]||"").length<s&&(a[1]=a[1]||"",a[1]+=(new Array(s-a[1].length+1)).join("0")),a.join(u)}var e=Date.now(),t=window.document,n=t.head;n.insertAdjacentHTML("afterBegin",'<avalon ms-skip class="avalonHide"><style id="avalonStyle">.avalonHide{ display: none!important }</style></avalon>');var r=n.firstChild,o="$"+e,u=!1,a=/[^, ]+/g,f=/^(?:object|array)$/,l=/^\[object SVG\w*Element\]$/,c=/^\[object (?:Window|DOMWindow|global)\]$/,h=Object.prototype,p=h.hasOwnProperty,d=h.toString,v=Array.prototype,m=v.slice,g={},y=window.dispatchEvent,b=t.documentElement,w=t.createDocumentFragment(),E=t.createElement("div"),S={};"Boolean Number String Function Array Date RegExp Object Error".replace(a,function(e){S["[object "+e+"]"]=e.toLowerCase()});var N=function(e){return e=e||"avalon",String(Math.random()+Math.random()).replace(/\d\.\d{4}/,e)},k=C();avalon=function(e){return new avalon.init(e)},avalon.profile=function(){window.console&&avalon.config.profile&&Function.apply.call(console.log,console,arguments)},avalon.nextTick=new function(){function s(){var e=i.length;for(var t=0;t<e;t++)i[t]();i=i.slice(e)}var e=window.setImmediate,r=window.MutationObserver;if(e)return e.bind(window);var i=[];if(r){var o=document.createTextNode("avalon");return(new r(s)).observe(o,{characterData:!0}),function(e){i.push(e),o.data=Math.random()}}return window.VBArray?function(e){i.push(e);var r=t.createElement("script");r.onreadystatechange=function(){s(),r.onreadystatechange=null,n.removeChild(r),r=null},n.appendChild(r)}:function(e){setTimeout(e,4)}},avalon.init=function(e){this[0]=this.element=e},avalon.fn=avalon.prototype=avalon.init.prototype,avalon.type=function(e){return e==null?String(e):typeof e=="object"||typeof e=="function"?S[d.call(e)]||"object":typeof e};var L=function(e){return d.call(e)==="[object Function]"};avalon.isFunction=L,avalon.isWindow=function(e){return c.test(d.call(e))},avalon.isPlainObject=function(e){return d.call(e)==="[object Object]"&&Object.getPrototypeOf(e)===h},avalon.mix=avalon.fn.mix=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;typeof o=="boolean"&&(f=o,o=arguments[1]||{},u++),typeof o!="object"&&!L(o)&&(o={}),u===a&&(o=this,u--);for(;u<a;u++)if((e=arguments[u])!=null)for(t in e){n=o[t],r=e[t];if(o===r)continue;f&&r&&(avalon.isPlainObject(r)||(i=Array.isArray(r)))?(i?(i=!1,s=n&&Array.isArray(n)?n:[]):s=n&&avalon.isPlainObject(n)?n:{},o[t]=avalon.mix(f,s,r)):r!==void 0&&(o[t]=r)}return o},avalon.mix({rword:a,subscribers:o,version:1.47,ui:{},log:i,slice:function(e,t,n){return m.call(e,t,n)},noop:x,error:function(e,t){throw new(t||Error)(e)},oneObject:T,range:function(e,t,n){n||(n=1),t==null&&(t=e||0,e=0);var r=-1,i=Math.max(0,Math.ceil((t-e)/n)),s=new Array(i);while(++r<i)s[r]=e,e+=n;return s},eventHooks:{},bind:function(e,t,n,r){var i=avalon.eventHooks,s=i[t];return typeof s=="object"&&(t=s.type||t,r=s.phase||!!r,n=s.fn?s.fn(e,n):n),e.addEventListener(t,n,r),n},unbind:function(e,t,n,r){var i=avalon.eventHooks,s=i[t],o=n||x;typeof s=="object"&&(t=s.type||t,r=s.phase||!!r),e.removeEventListener(t,o,r)},css:function(e,t,n){e instanceof avalon&&(e=e[0]);var r=/[_-]/.test(t)?jt(t):t,i;t=avalon.cssName(r)||r;if(n===void 0||typeof n=="boolean"){i=Rt[r+":get"]||Rt["@:get"],t==="background"&&(t="backgroundColor");var s=i(e,t);return n===!0?parseFloat(s)||0:s}if(n==="")e.style[t]="";else{if(n==null||n!==n)return;isFinite(n)&&!avalon.cssNumber[r]&&(n+="px"),i=Rt[r+":set"]||Rt["@:set"],i(e,t,n)}},each:function(e,t){if(e){var n=0;if(_(e)){for(var r=e.length;n<r;n++)if(t(n,e[n])===!1)break}else for(n in e)if(e.hasOwnProperty(n)&&t(n,e[n])===!1)break}},getWidgetData:function(e,t){var n=avalon(e).data(),r={};for(var i in n)i.indexOf(t)===0&&(r[i.replace(t,"").replace(/\w/,function(e){return e.toLowerCase()})]=n[i]);return r},Array:{ensure:function(e,t){if(e.indexOf(t)===-1)return e.push(t)},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(e,t){var n=e.indexOf(t);return~n?avalon.Array.removeAt(e,n):!1}}});var O=avalon.bindingHandlers={},M=avalon.bindingExecutors={},D=new function(){function e(e){this.size=0,this.limit=e,this.head=this.tail=void 0,this._keymap={}}var t=e.prototype;return t.put=function(e,t){var n={key:e,value:t};return this._keymap[e]=n,this.tail?(this.tail.newer=n,n.older=this.tail):this.head=n,this.tail=n,this.size===this.limit?this.shift():this.size++,t},t.shift=function(){var e=this.head;e&&(this.head=this.head.newer,this.head.older=e.newer=e.older=this._keymap[e.key]=void 0,delete this._keymap[e.key])},t.get=function(e){var t=this._keymap[e];if(t===void 0)return;return t===this.tail?t.value:(t.newer&&(t===this.head&&(this.head=t.newer),t.newer.older=t.older),t.older&&(t.older.newer=t.newer),t.newer=void 0,t.older=this.tail,this.tail&&(this.tail.newer=t),this.tail=t,t.value)},e};t.contains||(Node.prototype.contains=function(e){return!!(this.compareDocumentPosition(e)&16)}),avalon.contains=function(e,t){try{while(t=t.parentNode)if(t===e)return!0;return!1}catch(n){return!1}};if(window.SVGElement){var P="http://www.w3.org/2000/svg",H=t.createElementNS(P,"svg");H.innerHTML='<circle cx="50" cy="50" r="40" fill="red" />';if(!l.test(H.firstChild)){function B(e,n){if(e&&e.childNodes){var r=e.childNodes;for(var i=0,s;s=r[i++];)if(s.tagName){var o=t.createElementNS(P,s.tagName.toLowerCase());v.forEach.call(s.attributes,function(e){o.setAttribute(e.name,e.value)}),B(s,o),n.appendChild(o)}}}Object.defineProperties(SVGElement.prototype,{outerHTML:{enumerable:!0,configurable:!0,get:function(){return(new XMLSerializer).serializeToString(this)},set:function(e){var n=this.tagName.toLowerCase(),r=this.parentNode,i=avalon.parseHTML(e);if(n==="svg")r.insertBefore(i,this);else{var s=t.createDocumentFragment();B(i,s),r.insertBefore(s,this)}r.removeChild(this)}},innerHTML:{enumerable:!0,configurable:!0,get:function(){var e=this.outerHTML,t=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),n=new RegExp("</"+this.nodeName+">$","i");return e.replace(t,"").replace(n,"")},set:function(e){if(avalon.clearHTML){avalon.clearHTML(this);var t=avalon.parseHTML(e);B(t,this)}}}})}}var j=avalon.eventHooks;"onmouseenter"in b||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){j[e]={type:t,deel:function(t,n,r){return function(n){var i=n.relatedTarget;if(!i||i!==t&&!(t.compareDocumentPosition(i)&16))return delete n.type,n.type=e,r.call(t,n)}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(e,t){window[e]&&!j.animationend&&(j.animationend={type:t})}),t.onmousewheel===void 0&&(j.mousewheel={type:"wheel",fn:function(e,t){return function(n){n.wheelDeltaY=n.wheelDelta=n.deltaY>0?-120:120,n.wheelDeltaX=0,Object.defineProperty(n,"type",{value:"mousewheel"}),t.call(e,n)}}});var I,q,R,U,z,W=/[-.*+?^${}()|[\]\/\\]/g,V={interpolate:function(e){I=e[0],q=e[1];if(I===q)throw new SyntaxError("openTag===closeTag");var t=I+"test"+q;E.innerHTML=t;if(E.innerHTML!==t&&E.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("此定界符不合法");F.openTag=I,F.closeTag=q,E.innerHTML="";var n=X(I),r=X(q);R=new RegExp(n+"(.*?)"+r),U=new RegExp(n+"(.*?)"+r,"g"),z=new RegExp(n+".*?"+r+"|\\sms-")}};F.debug=!0,F.plugins=V,F.plugins.interpolate(["{{","}}"]),F.paths={},F.shim={},F.maxRepeatSize=100,avalon.config=F;var $=/(\w+)\[(avalonctrl)="(\S+)"\]/,J=function(e){return t.querySelectorAll(e)},K={$watch:function(e,t){if(typeof t=="function"){var n=this.$events[e];n?n.push(t):this.$events[e]=[t]}else this.$events=this.$watch.backup;return this},$unwatch:function(e,t){var n=arguments.length;if(n===0)this.$watch.backup=this.$events,this.$events={};else if(n===1)this.$events[e]=[];else{var r=this.$events[e]||[],i=r.length;while(~--i<0)if(r[i]===t)return r.splice(i,1)}return this},$fire:function(e){var n,r,i,s;/^(\w+)!(\S+)$/.test(e)&&(n=RegExp.$1,e=RegExp.$2);var o=this.$events;if(!o)return;var u=m.call(arguments,1),a=[e].concat(u);if(n==="all")for(r in avalon.vmodels)i=avalon.vmodels[r],i!==this&&i.$fire.apply(i,a);else if(n==="up"||n==="down"){var f=o.expr?J(o.expr):[];if(f.length===0)return;for(r in avalon.vmodels){i=avalon.vmodels[r];if(i!==this&&i.$events.expr){var l=J(i.$events.expr);if(l.length===0)continue;v.forEach.call(l,function(e){v.forEach.call(f,function(t){var r=n==="down"?t.contains(e):e.contains(t);r&&(e._avalon=i)})})}}var c=t.getElementsByTagName("*"),h=[];v.forEach.call(c,function(e){e._avalon&&(h.push(e._avalon),e._avalon="",e.removeAttribute("_avalon"))}),n==="up"&&h.reverse();for(r=0;s=h[r++];)if(s.$fire.apply(s,a)===!1)break}else{var p=o[e]||[],d=o.$all||[];for(r=0;s=p[r++];)L(s)&&s.apply(this,u);for(r=0;s=d[r++];)L(s)&&s.apply(this,arguments)}}},Q=avalon.vmodels={};avalon.define=function(e,t){var n=e.$id||e;n||i("warning: vm必须指定$id"),Q[n]&&i("warning: "+n+" 已经存在于avalon.vmodels中");if(typeof e=="object")var r=Y(e);else{var s={$watch:x};t(s),r=Y(s),u=!0,t(r),u=!1}return r.$id=n,Q[n]=r};var G=String("$id,$watch,$unwatch,$fire,$events,$model,$skipArray,$reinitialize").match(a),at=Object.is||function(e,t){return e===0&&t===0?1/e===1/t:e!==e?t!==t:e===t},lt=function(e){var t={};for(var n in e)t[n]={get:e[n],set:e[n],enumerable:!0,configurable:!0};return t},pt=v.splice,dt={_splice:pt,_fire:function(e,t,n){wt(this.$events[o],e,t,n)},size:function(){return this._.length},pushArray:function(e){var t=e.length,n=this.length;return t&&(v.push.apply(this.$model,e),ht.call(this,"add",n,t,Math.max(0,n-1))),t+n},push:function(){var e=[],t,n=arguments.length;for(t=0;t<n;t++)e[t]=arguments[t];return this.pushArray(e)},unshift:function(){var e=arguments.length,t=this.length;return e&&(v.unshift.apply(this.$model,arguments),ht.call(this,"add",0,e,0)),e+t},shift:function(){if(this.length){var e=this.$model.shift();return ht.call(this,"del",0,1,0),e}},pop:function(){var e=this.length;if(e){var t=this.$model.pop();return ht.call(this,"del",e-1,1,Math.max(0,e-2)),t}},splice:function(e){var t=arguments.length,n=[],r,i=pt.apply(this.$model,arguments);return i.length&&(n.push("del",e,i.length,0),r=!0),t>2&&(r?n.splice(3,1,0,"add",e,t-2):n.push("add",e,t-2,0),r=!0),r?ht.apply(this,n):[]},contains:function(e){return this.indexOf(e)!==-1},remove:function(e){return this.removeAt(this.indexOf(e))},removeAt:function(e){return e>=0?(this.$model.splice(e,1),ht.call(this,"del",e,1,0)):[]},clear:function(){return this.$model.length=this.length=this._.length=0,this._fire("clear",0),this},removeAll:function(e){if(Array.isArray(e))for(var t=this.length-1;t>=0;t--)e.indexOf(this[t])!==-1&&this.removeAt(t);else if(typeof e=="function")for(t=this.length-1;t>=0;t--){var n=this[t];e(n,t)&&this.removeAt(t)}else this.clear()},ensure:function(e){return this.contains(e)||this.push(e),this},set:function(e,t){if(e<this.length&&e>-1){var n=avalon.type(t);t&&t.$model&&(t=t.$model);var r=this[e];if(n==="object")for(var i in t)r.hasOwnProperty(i)&&(r[i]=t[i]);else n==="array"?r.clear().push.apply(r,t):r!==t&&(this[e]=t,this.$model[e]=t,this._fire("set",e,t))}return this}};"sort,reverse".replace(a,function(e){dt[e]=function(){var t=this.$model,n=t.concat(),r=Math.random(),i=[],s;v[e].apply(t,arguments);for(var o=0,u=n.length;o<u;o++){var a=t[o],f=n[o];if(at(a,f))i.push(o);else{var l=n.indexOf(a);i.push(l),n[l]=r,s=!0}}return s&&(mt(this,i),this._fire("move",i),this._fire("index",0)),this}});var gt=function(){var e=[],t;return{begin:function(n){e.push(t),t=n},end:function(){t=e.pop()},collectDependency:function(e,n){t&&t.callback(e,n)}}}(),yt=/^(duplex|on)$/;avalon.injectBinding=function(e){var n=e.evaluator;if(n){gt.begin({callback:function(t,n){bt(t.$events[n._name],e)}});try{var r=yt.test(e.type)?e:n.apply(0,e.args);r===void 0&&delete e.evaluator,e.handler&&e.handler(r,e.element,e)}catch(s){i("warning:exception throwed in [avalon.injectBinding] ",s),delete e.evaluator;var o=e.element;if(o&&o.nodeType===3){var u=o.parentNode;F.commentInterpolate?u.replaceChild(t.createComment(e.value),o):o.data=I+(e.oneTime?"::":"")+e.value+q}}finally{gt.end()}}};var Et=0,St=avalon.$$subscribers=[],xt=new Date,Tt={},Ot=new function(){avalon.mix(this,{option:t.createElement("select"),thead:t.createElement("table"),td:t.createElement("tr"),area:t.createElement("map"),tr:t.createElement("tbody"),col:t.createElement("colgroup"),legend:t.createElement("fieldset"),_default:t.createElement("div"),g:t.createElementNS("http://www.w3.org/2000/svg","svg")}),this.optgroup=this.option,this.tbody=this.tfoot=this.colgroup=this.caption=this.thead,this.th=this.td};String("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use").replace(a,function(e){Ot[e]=Ot.g});var Mt=/<([\w:]+)/,_t=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Dt=T(["","text/javascript","text/ecmascript","application/ecmascript","application/javascript"]),Pt=t.createElement("script"),Ht=/<|&#?\w+;/;avalon.parseHTML=function(e){var n=w.cloneNode(!1);if(typeof e!="string")return n;if(!Ht.test(e))return n.appendChild(t.createTextNode(e)),n;e=e.replace(_t,"<$1></$2>").trim();var r=(Mt.exec(e)||["",""])[1].toLowerCase(),i=Ot[r]||Ot._default,s;i.innerHTML=e;var o=i.getElementsByTagName("script");if(o.length)for(var u=0,a;a=o[u++];)if(Dt[a.type]){var f=Pt.cloneNode(!1);v.forEach.call(a.attributes,function(e){f.setAttribute(e.name,e.value)}),f.text=a.text,a.parentNode.replaceChild(f,a)}while(s=i.firstChild)n.appendChild(s);return n},avalon.innerHTML=function(e,t){var n=this.parseHTML(t);this.clearHTML(e).appendChild(n)},avalon.clearHTML=function(e){e.textContent="";while(e.firstChild)e.removeChild(e.firstChild);return e},"add,remove".replace(a,function(e){avalon.fn[e+"Class"]=function(t){var n=this[0];return t&&typeof t=="string"&&n&&n.nodeType===1&&t.replace(/\S+/g,function(t){n.classList[e](t)}),this}}),avalon.fn.mix({hasClass:function(e){var t=this[0]||{};return t.nodeType===1&&t.classList.contains(e)},toggleClass:function(e,t){var n,r=0,i=String(e).split(/\s+/),s=typeof t=="boolean";while(n=i[r++]){var o=s?t:!this.hasClass(n);this[o?"addClass":"removeClass"](n)}return this},attr:function(e,t){return arguments.length===2?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)},data:function(e,t){e="data-"+Bt(e||"");switch(arguments.length){case 2:return this.attr(e,t),this;case 1:var n=this.attr(e);return It(n);case 0:var r={};return v.forEach.call(this[0].attributes,function(t){t&&(e=t.name,e.indexOf("data-")||(e=jt(e.slice(5)),r[e]=It(t.value)))}),r}},removeData:function(e){return e="data-"+Bt(e),this[0].removeAttribute(e),this},css:function(e,t){if(avalon.isPlainObject(e))for(var n in e)avalon.css(this,n,e[n]);else var r=avalon.css(this,e,t);return r!==void 0?r:this},position:function(){var e,t,n=this[0],r={top:0,left:0};if(!n)return;return this.css("position")==="fixed"?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),e[0].tagName!=="HTML"&&(r=e.offset()),r.top+=avalon.css(e[0],"borderTopWidth",!0),r.left+=avalon.css(e[0],"borderLeftWidth",!0),r.top-=e.scrollTop(),r.left-=e.scrollLeft()),{top:t.top-r.top-avalon.css(n,"marginTop",!0),left:t.left-r.left-avalon.css(n,"marginLeft",!0)}},offsetParent:function(){var e=this[0].offsetParent;while(e&&avalon.css(e,"position")==="static")e=e.offsetParent;return avalon(e||b)},bind:function(e,t,n){if(this[0])return avalon.bind(this[0],e,t,n)},unbind:function(e,t,n){return this[0]&&avalon.unbind(this[0],e,t,n),this},val:function(e){var t=this[0];if(t&&t.nodeType===1){var n=arguments.length===0,r=n?":get":":set",i=Jt[$t(t)+r];if(i)var s=i(t,e);else{if(n)return(t.value||"").replace(/\r/g,"");t.value=e}}return n?s:this}}),b.dataset&&(avalon.fn.data=function(e,t){e=e&&jt(e);var n=this[0].dataset;switch(arguments.length){case 2:return n[e]=t,this;case 1:return t=n[e],It(t);case 0:var r=s();for(e in n)r[e]=It(n[e]);return r}});var Ft=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/;avalon.parseJSON=JSON.parse,avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){avalon.fn[e]=function(n){var r=this[0]||{},i=qt(r),s=e==="scrollTop";if(!arguments.length)return i?i[t]:r[e];i?i.scrollTo(s?i[t]:n,s?n:i[t]):r[e]=n}});var Rt=avalon.cssHooks=s(),Ut=["","-webkit-","-moz-","-ms-"],zt={"float":"cssFloat"};avalon.cssNumber=T("animationIterationCount,columnCount,order,flex,flexGrow,flexShrink,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(e,t,n){if(zt[e])return zt[e];t=t||b.style;for(var r=0,i=Ut.length;r<i;r++){n=jt(Ut[r]+e);if(n in t)return zt[e]=n}return null},Rt["@:set"]=function(e,t,n){e.style[t]=n},Rt["@:get"]=function(e,t){if(!e||!e.style)throw new Error("getComputedStyle要求传入一个节点 "+e);var n,r=getComputedStyle(e);return r&&(n=t==="filter"?r.getPropertyValue(t):r[t],n===""&&(n=e.style[t])),n},Rt["opacity:get"]=function(e){var t=Rt["@:get"](e,"opacity");return t===""?"1":t},"top,left".replace(a,function(e){Rt[e+":get"]=function(t){var n=Rt["@:get"](t,e);return/px$/.test(n)?n:avalon(t).position()[e]+"px"}});var Wt={position:"absolute",visibility:"hidden",display:"block"},Xt=/^(none|table(?!-c[ea]).+)/;"Width,Height".replace(a,function(e){var t=e.toLowerCase(),n="client"+e,r="scroll"+e,i="offset"+e;Rt[t+":get"]=function(t,n,r){var s=-4;typeof r=="number"&&(s=r),n=e==="Width"?["Left","Right"]:["Top"
,"Bottom"];var o=t[i];return s===2?o+avalon.css(t,"margin"+n[0],!0)+avalon.css(t,"margin"+n[1],!0):(s<0&&(o=o-avalon.css(t,"border"+n[0]+"Width",!0)-avalon.css(t,"border"+n[1]+"Width",!0)),s===-4&&(o=o-avalon.css(t,"padding"+n[0],!0)-avalon.css(t,"padding"+n[1],!0)),o)},Rt[t+"&get"]=function(e){var n=[];Vt(e,n);var r=Rt[t+":get"](e);for(var i=0,s;s=n[i++];){e=s.node;for(var o in s)typeof s[o]=="string"&&(e.style[o]=s[o])}return r},avalon.fn[t]=function(s){var o=this[0];if(arguments.length===0){if(o.setTimeout)return o["inner"+e];if(o.nodeType===9){var u=o.documentElement;return Math.max(o.body[r],u[r],o.body[i],u[i],u[n])}return Rt[t+"&get"](o)}return this.css(t,s)},avalon.fn["inner"+e]=function(){return Rt[t+":get"](this[0],void 0,-2)},avalon.fn["outer"+e]=function(e){return Rt[t+":get"](this[0],void 0,e===!0?2:0)}}),avalon.fn.offset=function(){var e=this[0];try{var t=e.getBoundingClientRect();if(t.width||t.height||e.getClientRects().length){var n=e.ownerDocument,r=n.documentElement,i=n.defaultView;return{top:t.top+i.pageYOffset-r.clientTop,left:t.left+i.pageXOffset-r.clientLeft}}}catch(s){return{left:0,top:0}}};var Jt={"select:get":function(e,t){var n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&!n.disabled){t=n.value;if(s)return t;o.push(t)}}return o},"select:set":function(e,t,n){t=[].concat(t);for(var r=0,i;i=e.options[r++];)if(i.selected=t.indexOf(i.value)>-1)n=!0;n||(e.selectedIndex=-1)}},Kt=JSON.stringify,Qt=["break,case,catch,continue,debugger,default,delete,do,else,false","finally,for,function,if,in,instanceof,new,null,return,switch,this","throw,true,try,typeof,var,void,while,with","abstract,boolean,byte,char,class,const,double,enum,export,extends","final,float,goto,implements,import,int,interface,long,native","package,private,protected,public,short,static,super,synchronized","throws,transient,volatile","arguments,let,yield,undefined"].join(","),Gt=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,Yt=/[^\w$]+/g,Zt=new RegExp(["\\b"+Qt.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),en=/\b\d[^,]*/g,tn=/^,+|,+$/g,nn=new D(512),rn=function(e){var t=","+e.trim(),n=nn.get(t);if(n)return n;var r=e.replace(Gt,"").replace(Yt,",").replace(Zt,"").replace(en,"").replace(tn,"").split(/^$|,+/);return nn.put(t,on(r))},un=new D(128),an=/\w\[.*\]|\w\.\w/,fn=/(\$proxy\$[a-z]+)\d+$/,ln=/\)\s*$/,cn=/\)\s*\|/g,hn=/\|\s*([$\w]+)/g,pn=/"\s*\["/g,dn=/"\s*\(/g;avalon.parseExprProxy=yn,avalon.scan=function(e,t){e=e||b;var n=t?[].concat(t):[];Bn(e,n)};var bn=T("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr,noscript,script,style,textarea".toUpperCase()),Sn=function(e,t,n){var r=e.getAttribute(t);if(r)for(var i=0,s;s=n[i++];)if(s.hasOwnProperty(r)&&typeof s[r]=="function")return s[r]},Tn=k&&window.MutationObserver?function(e){var t=e.firstChild,n;while(t){var r=t.nextSibling;t.nodeType===3?n?(n.nodeValue+=t.nodeValue,e.removeChild(t)):n=t:n=null,t=r}}:0,Nn=/^\s*::/,Cn=/ms-(\w+)-?(.*)/,kn={"if":10,repeat:90,data:100,widget:110,each:1400,"with":1500,duplex:2e3,on:3e3},Ln=T("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit"),An=T("value,title,alt,checked,selected,disabled,readonly,enabled"),_n=/^if|widget|repeat$/,Dn=/^each|with|html|include$/,jn=/\|\s*html(?:\b|$)/,Fn=/\|\|/g,In=/&lt;/g,qn=/&gt;/g,Rn=/(['"])(\\\1|.)+?\1/g,Xn=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected","contentEditable,isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(","),Vn={};Xn.replace(a,function(e){Vn[e.toLowerCase()]=e});var $n={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"},Jn=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,frameBorder,longDesc,maxLength,marginWidth,marginHeight","rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(",");Jn.replace(a,function(e){$n[e.toLowerCase()]=e});var Kn=/<noscript.*?>(?:[\s\S]+?)<\/noscript>/img,Qn=/<noscript.*?>([\s\S]+?)<\/noscript>/im,Gn=function(){return new(window.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP")},Yn=avalon.templateCache={};O.attr=function(e,n){var r=gn(e.value.trim());if(e.type==="include"){var i=e.element;e.includeRendered=Sn(i,"data-include-rendered",n),e.includeLoaded=Sn(i,"data-include-loaded",n);var s=e.includeReplace=!!avalon(i).data("includeReplace");avalon(i).data("includeCache")&&(e.templateCache={}),e.startInclude=t.createComment("ms-include"),e.endInclude=t.createComment("ms-include-end"),s?(e.element=e.startInclude,i.parentNode.insertBefore(e.startInclude,i),i.parentNode.insertBefore(e.endInclude,i.nextSibling)):(i.insertBefore(e.startInclude,i.firstChild),i.appendChild(e.endInclude))}e.handlerName="attr",yn(r,n,e)},M.attr=function(e,n,i){var s=i.type,o=i.param;if(s==="css")avalon(n).css(o,e);else if(s==="attr"){var u=e===!1||e===null||e===void 0;!y&&$n[o]&&(o=$n[o]);var a=Vn[o];typeof n[a]=="boolean"&&(n[a]=!!e,e||(u=!0));if(u)return n.removeAttribute(o);var f=l.test(n)?!1:t.namespaces&&isVML(n)?!0:o in n.cloneNode(!1);f?n[o]=e+"":n.setAttribute(o,e)}else if(s==="include"&&e){var c=i.vmodels,h=i.includeRendered,p=i.includeLoaded,d=i.includeReplace,v=d?n.parentNode:n,m=function(n){if(i.vmodels===null)return;if(p){var s=p.apply(v,[n].concat(c));typeof s=="string"&&(n=s)}h&&wn(v,function(){h.call(v)},NaN);var o=i.includeLastID;if(i.templateCache&&o&&o!==e){var u=i.templateCache[o];u||(u=i.templateCache[o]=t.createElement("div"),r.appendChild(u))}i.includeLastID=e;while(i.startInclude){var a=i.startInclude.nextSibling;if(!a||a===i.endInclude)break;v.removeChild(a),u&&u.appendChild(a)}var f=Zn(i,e,n),l=avalon.slice(f.childNodes);v.insertBefore(f,i.endInclude),Hn(l,c)};if(i.param==="src")if(typeof Yn[e]=="string")avalon.nextTick(function(){m(Yn[e])});else if(Array.isArray(Yn[e]))Yn[e].push(m);else{var g=Gn();g.onreadystatechange=function(){if(g.readyState===4){var t=g.status;if(t>=200&&t<300||t===304||t===1223){var n=g.responseText;for(var r=0,i;i=Yn[e][r++];)i(n);Yn[e]=n}}},Yn[e]=[m],g.open("GET",e,!0),"withCredentials"in g&&(g.withCredentials=!0),g.setRequestHeader("X-Requested-With","XMLHttpRequest"),g.send(null)}else{var w=e&&e.nodeType===1?e:t.getElementById(e);if(w){if(w.tagName==="NOSCRIPT"&&!w.innerHTML&&!w.fixIE78){g=Gn(),g.open("GET",location,!1),g.send(null);var E=t.getElementsByTagName("noscript"),S=(g.responseText||"").match(Kn)||[],x=S.length;for(var T=0;T<x;T++){var N=E[T];N&&(N.style.display="none",N.fixIE78=(S[T].match(Qn)||["","&nbsp;"])[1])}}avalon.nextTick(function(){m(w.fixIE78||w.value||w.innerText||w.innerHTML)})}}}else{!b.hasAttribute&&typeof e=="string"&&(s==="src"||s==="href")&&(e=e.replace(/&amp;/g,"&")),n[s]=e;if(window.chrome&&n.tagName==="EMBED"){var C=n.parentNode,k=document.createComment("ms-src");C.replaceChild(k,n),C.replaceChild(n,k)}}},"title,alt,src,value,css,include,href".replace(a,function(e){O[e]=O.attr}),O["class"]=function(e,t){var n=e.param,r=e.value,i;e.handlerName="class";if(!n||isFinite(n)){e.param="";var s=r.replace(U,function(e){return e.replace(/./g,"0")}).indexOf(":");if(s===-1){var o=r;i=!0}else o=r.slice(0,s),i=r.slice(s+1);R.test(r)?o=gn(o):o=Kt(o),e.expr="["+o+","+i+"]"}else e.expr="["+Kt(n)+","+r+"]",e.oldStyle=n;var u=e.type;if(u==="hover"||u==="active"){if(!e.hasBindEvent){var a=e.element,f=avalon(a),l="mouseenter",c="mouseleave";if(u==="active"){a.tabIndex=a.tabIndex||-1,l="mousedown",c="mouseup";var h=f.bind("mouseleave",function(){e.toggleClass&&f.removeClass(e.newClass)})}}var p=f.bind(l,function(){e.toggleClass&&f.addClass(e.newClass)}),d=f.bind(c,function(){e.toggleClass&&f.removeClass(e.newClass)});e.rollback=function(){f.unbind("mouseleave",h),f.unbind(l,p),f.unbind(c,d)},e.hasBindEvent=!0}yn(e.expr,t,e)},M["class"]=function(e,t,n){var r=avalon(t);n.newClass=e[0],n.toggleClass=!!e[1],n.oldClass&&n.newClass!==n.oldClass&&r.removeClass(n.oldClass),n.oldClass=n.newClass,n.type==="class"&&(n.oldStyle?r.toggleClass(n.oldStyle,!!e[1]):r.toggleClass(n.newClass,n.toggleClass))},"hover,active".replace(a,function(e){O[e]=O["class"]}),M.data=function(e,t,n){var r="data-"+n.param;e&&typeof e=="object"?t[r]=e:t.setAttribute(r,String(e))};var er=O.duplex=function(e,t){var n=e.element,r;yn(e.value,t,e,1),e.changed=Sn(n,"data-duplex-changed",t)||x;if(e.evaluator&&e.args){var s=[],o=T("string,number,boolean,checked");n.type==="radio"&&e.param===""&&(e.param="checked"),n.msData&&(n.msData["ms-duplex"]=e.value),e.param.replace(/\w+/g,function(t){/^(checkbox|radio)$/.test(n.type)&&/^(radio|checked)$/.test(t)&&(t==="radio"&&i("ms-duplex-radio已经更名为ms-duplex-checked"),t="checked",e.isChecked=!0),t==="bool"?(t="boolean",i("ms-duplex-bool已经更名为ms-duplex-boolean")):t==="text"&&(t="string",i("ms-duplex-text已经更名为ms-duplex-string")),o[t]&&(r=!0),avalon.Array.ensure(s,t)}),r||s.push("string"),e.param=s.join("-"),e.bound=function(t,r){n.addEventListener?n.addEventListener(t,r,!1):n.attachEvent("on"+t,r);var i=e.rollback;e.rollback=function(){n.avalonSetter=null,avalon.unbind(n,t,r),i&&i()}};for(var u in avalon.vmodels){var a=avalon.vmodels[u];a.$fire("avalon-ms-duplex-init",e)}var f=e.pipe||(e.pipe=nr);f(null,e,"init");var l=n.tagName;er[l]&&er[l](n,e.evaluator.apply(null,e.args),e)}};avalon.duplexHooks={checked:{get:function(e,t){return!t.element.oldValue}},string:{get:function(e){return e},set:tr},"boolean":{get:function(e){return e==="true"},set:tr},number:{get:function(e,t){var n=parseFloat(e);if(-e===-n)return n;var r=/strong|medium|weak/.exec(t.element.getAttribute("data-duplex-number"))||["medium"];switch(r[0]){case"strong":return 0;case"medium":return e===""?"":0;case"weak":return e}},set:tr}};var rr,ir=[];avalon.tick=function(e){ir.push(e)===1&&(rr=setInterval(sr,60))};var or=x;new function(){try{var e={},t=HTMLInputElement.prototype,n=HTMLTextAreaElement.prototype;function r(t){e[this.tagName].call(this,t),!this.msFocus&&this.avalonSetter&&this.oldValue!==t&&this.avalonSetter()}var i=HTMLInputElement.prototype;Object.getOwnPropertyNames(i),e.INPUT=Object.getOwnPropertyDescriptor(t,"value").set,Object.defineProperty(t,"value",{set:r}),e.TEXTAREA=Object.getOwnPropertyDescriptor(n,"value").set,Object.defineProperty(n,"value",{set:r})}catch(s){or=avalon.tick}};var ur=/^(file|button|reset|submit|checkbox|radio|range)$/;er.INPUT=function(e,t,n){function f(e){n.changed.call(this,e,n)}function l(){u=!0}function c(){u=!1}var r=e.type,s=n.bound,o=avalon(e),u=!1,h=function(){var r=e.value;if(u||r===e.oldValue)return;var i=n.pipe(r,n,"get");o.data("duplexObserve")!==!1&&(t(i),f.call(e,i))};n.handler=function(){var r=n.pipe(t(),n,"set");if(r!==e.oldValue){var i=!1;if(e.msFocus){var s=e.selectionStart,o=e.selectionEnd;if(s===o){var u=s;i=!0}}e.value=e.oldValue=r,i&&(e.selectionStart=e.selectionEnd=u)}};if(n.isChecked||r==="radio")h=function(){if(o.data("duplexObserve")!==!1){var r=n.pipe(e.value,n,"get");t(r),f.call(e,r)}},n.handler=function(){var r=t(),i=n.isChecked?!!r:r+""===e.value;e.checked=e.oldValue=i},s("click",h);else if(r==="checkbox")h=function(){if(o.data("duplexObserve")!==!1){var r=e.checked?"ensure":"remove",s=t();Array.isArray(s)||(i("ms-duplex应用于checkbox上要对应一个数组"),s=[s]),avalon.Array[r](s,n.pipe(e.value,n,"get")),f.call(e,s)}},n.handler=function(){var r=[].concat(t());e.checked=r.indexOf(n.pipe(e.value,n,"get"))>-1},s("change",h);else{var p=e.getAttribute("data-duplex-event")||"input";e.attributes["data-event"]&&i("data-event指令已经废弃，请改用data-duplex-event"),p.replace(a,function(e){switch(e){case"input":s("input",h),s("DOMAutoComplete",h),k||(s("compositionstart",l),s("compositionend",c));break;default:s(e,h)}}),ur.test(r)||(r!=="hidden"&&(s("focus",function(){e.msFocus=!0}),s("blur",function(){e.msFocus=!1})),e.avalonSetter=h,or(function(){if(b.contains(e))!e.msFocus&&n.oldValue!==e.value&&h();else if(!e.msRetain)return!1}))}avalon.injectBinding(n),f.call(e,e.value)},er.TEXTAREA=er.INPUT,er.SELECT=function(e,t,n){function s(){if(r.data("duplexObserve")!==!1){var i=r.val();Array.isArray(i)?i=i.map(function(e){return n.pipe(e,n,"get")}):i=n.pipe(i,n,"get"),i+""!==e.oldValue&&t(i),n.changed.call(e,i,n)}}var r=avalon(e);n.handler=function(){var n=t();n=n&&n.$model||n,Array.isArray(n)?e.multiple||i("ms-duplex在<select multiple=true>上要求对应一个数组"):e.multiple&&i("ms-duplex在<select multiple=false>不能对应一个数组"),n=Array.isArray(n)?n.map(String):n+"",n+""!==e.oldValue&&(r.val(n),e.oldValue=n+"")},n.bound("change",s),e.msCallback=function(){avalon.injectBinding(n),n.changed.call(e,t(),n)}},M.html=function(e,n,r){var i=n.nodeType!==1,s=i?n.parentNode:n;if(!s)return;e=e==null?"":e;if(r.oldText===e)return;r.oldText=e;if(n.nodeType===3){var o=N("html");s.insertBefore(t.createComment(o),n),r.element=t.createComment(o+":end"),s.replaceChild(r.element,n),n=r.element}if(typeof e!="object")var u=avalon.parseHTML(String(e));else if(e.nodeType===11)u=e;else if(e.nodeType===1||e.item){var a=e.nodeType===1?e.childNodes:e.item;u=w.cloneNode(!0);while(a[0])u.appendChild(a[0])}a=avalon.slice(u.childNodes);if(i){var f=n.nodeValue.slice(0,-4);for(;;){var l=n.previousSibling;if(!l||l.nodeType===8&&l.nodeValue===f)break;s.removeChild(l)}s.insertBefore(u,n)}else avalon.clearHTML(n).appendChild(u);Hn(a,r.vmodels)},O["if"]=O.data=O.text=O.html=function(e,t){yn(e.value,t,e)},M["if"]=function(e,n,i){try{if(!n.parentNode)return}catch(s){return}if(e)n.nodeType===8&&(n.parentNode.replaceChild(i.template,n),n.ifRemove=null,n=i.element=i.template),n.getAttribute(i.name)&&(n.removeAttribute(i.name),Mn(n,i.vmodels)),i.rollback=null;else if(n.nodeType===1){var o=i.element=t.createComment("ms-if");n.parentNode.replaceChild(o,n),n.ifRemove=o,i.template=n,r.appendChild(n),i.rollback=function(){n.parentNode===r&&r.removeChild(n)}}};var ar=/\(([^)]*)\)/;O.on=function(e,t){var n=e.value;e.type="on";var r=e.param.replace(/-\d+$/,"");typeof O.on[r+"Hook"]=="function"&&O.on[r+"Hook"](e);if(n.indexOf("(")>0&&n.indexOf(")")>-1){var i=(n.match(ar)||["",""])[1].trim();if(i===""||i==="$event")n=n.replace(ar,"")}yn(n,t,e)},M.on=function(e,t,n){e=function(e){var t=n.evaluator||x;return t.apply(this,n.args.concat(e))};var r=n.param.replace(/-\d+$/,"");if(r==="scan")e.call(t,{type:r});else if(typeof n.specialBind=="function")n.specialBind(t,e);else var i=avalon.bind(t,r,e);n.rollback=function(){typeof n.specialUnbind=="function"?n.specialUnbind():avalon.unbind(t,r,i)}},O.repeat=function(e,n){var r=e.type;yn(e.value,n,e,1),e.proxies=[];var i=!1;try{var s=e.$repeat=e.evaluator.apply(0,e.args||[]),u=avalon.type(s);u!=="object"&&u!=="array"?(i=!0,avalon.log("warning:"+e.value+"只能是对象或数组")):e.xtype=u}catch(a){i=!0}var f=e.value.split(".")||[];if(f.length>1){f.pop();var l=f[0];for(var c=0,h;h=n[c++];)if(h&&h.hasOwnProperty(l)){var p=h[l].$events||{};p[o]=p[o]||[],p[o].push(e);break}}var d=e.handler;e.handler=x,avalon.injectBinding(e),e.handler=d;var v=e.element;if(v.nodeType===1){v.removeAttribute(e.name),e.sortedCallback=Sn(v,"data-with-sorted",n),e.renderedCallback=Sn(v,"data-"+r+"-rendered",n);var m=N(r),g=t.createComment(m),y=t.createComment(m+":end");e.signature=m,e.template=w.cloneNode(!1);if(r==="repeat"){var b=v.parentNode;b.replaceChild(y,v),b.insertBefore(g,y),e.template.appendChild(v)}else{while(v.firstChild)e.template.appendChild(v.firstChild);v.appendChild(g),v.appendChild(y)}e.element=y,e.handler=M.repeat,e.rollback=function(){var t=e.element;if(!t)return;e.handler("clear")}}if(i)return;e.$outer={};var E="$key",S="$val";Array.isArray(s)&&(E="$first",S="$last");for(c=0;h=n[c++];)if(h.hasOwnProperty(E)&&h.hasOwnProperty(S)){e.$outer=h;break}var T=s.$events,C=(T||{})[o];bt(C,e),u==="object"?e.handler("append"):s.length&&e.handler("add",0,s.length)},M.repeat=function(e,t,n){var r=this;if(!e&&r.xtype){var i=r.$repeat,s=r.evaluator.apply(0,r.args||[]);if(r.xtype==="array"){if(i.length===s.length){if(!(i!==s&&i.length>0))return;M.repeat.call(this,"clear",t,n)}e="add",t=0,r.$repeat=s,n=s.length}else{if(et(i).join(";;")===et(s).join(";;"))return;e="append",r.$repeat=s}}if(e){var o,u,a=r.element,f=lr(r),l=a.parentNode,c=r.proxies,h=w.cloneNode(!1);switch(e){case"add":var p=t+n,d=[];for(var v=t;v<p;v++){var m=br(v,r);c.splice(v,0,m),fr(r,h,m,d)}l.insertBefore(h,f[t]||a);for(v=0;u=d[v++];)Hn(u.nodes,u.vmodels),u.nodes=u.vmodels=null;break;case"del":cr(f[t],f[t+n]||a);var g=c.splice(t,n);vr(g,"each");break;case"clear":o=f[0],o&&(cr(o,a),r.xtype==="object"?l.insertBefore(o,a):vr(c,"each"));break;case"move":o=f[0];if(o){var y=o.nodeValue,b=[],E=[],S;cr(o,a,function(){E.unshift(this),this.nodeValue===y&&(b.unshift(E),E=[])}),mt(b,t),mt(c,t);while(E=b.shift())while(S=E.shift())h.appendChild(S);l.insertBefore(h,a)}break;case"index":var T=c.length-1;for(;n=c[t];t++)n.$index=t,n.$first=t===0,n.$last=t===T;return;case"set":m=c[t],m&&wt(m.$events[r.param||"el"]);break;case"append":var N=r.$repeat,C=Array.isArray(c)||!c?{}:c;r.proxies=C;var k=[];d=[];for(var L in C)N.hasOwnProperty(L)||(wr(C[L],hr),delete C[L]);for(L in N)N.hasOwnProperty(L)&&L!=="hasOwnProperty"&&k.push(L);if(r.sortedCallback){var A=r.sortedCallback.call(l,k);A&&Array.isArray(A)&&A.length&&(k=A)}for(v=0;L=k[v++];)L!=="hasOwnProperty"&&(C[L]=dr(C[L],L,r),fr(r,h,C[L],d));l.insertBefore(h,a);for(v=0;u=d[v++];)Hn(u.nodes,u.vmodels),u.nodes=u.vmodels=null}if(!r.$repeat||r.$repeat.hasOwnProperty("$lock"))return;e==="clear"&&(e="del");var O=r.renderedCallback||x,_=arguments;l.oldValue&&l.tagName==="SELECT"&&avalon(l).val(l.oldValue.split(",")),O.apply(l,_)}},"with,each".replace(a,function(e){O[e]=O.repeat});var hr=[],gr=[];M.text=function(e,t){e=e==null?"":e;if(t.nodeType===3)try{t.data=e}catch(n){}else t.textContent=e},avalon.parseDisplay=Er,O.visible=function(e,t){yn(e.value,t,e)},M.visible=function(e,t,n){e?(t.style.display=n.display||"",avalon(t).css("display")==="none"&&(t.style.display=n.display=Er(t.nodeName))):t.style.display="none"},O.widget=function(e,t){var n=e.value.match(a),r=e.element,s=n[0],o=n[1];if(!o||o==="$")o=N(s);var u=n[2]||s,f=avalon.ui[s];if(typeof f=="function"){t=r.vmodels||t;for(var l=0,c;c=t[l++];)if(c.hasOwnProperty(u)&&typeof c[u]=="object"){var h=c[u];h=h.$model||h;break}if(h){var p=h[s+"Id"];typeof p=="string"&&(i("warning!不再支持"+s+"Id"),o=p)}var d=avalon.getWidgetData(r,s);e.value=[s,o,u].join(","),e[s+"Id"]=o,e.evaluator=x,r.msData["ms-widget-id"]=o;var v=e[s+"Options"]=avalon.mix({},f.defaults,h||{},d);r.removeAttribute("ms-widget");var m=f(r,e,t)||{};if(m.$id){avalon.vmodels[o]=m,En(r,m);try{m.$init(function(){avalon.scan(r,[m].concat(t)),typeof v.onInit=="function"&&v.onInit.call(r,m,v,t)})}catch(g){}e.rollback=function(){try{m.$remove(),m.widgetElement=null}catch(e){}r.msData={},delete avalon.vmodels[m.$id]},Ct(e,Sr),window.chrome&&r.addEventListener("DOMNodeRemovedFromDocument",function(){setTimeout(kt)})}else avalon.scan(r,t)}else t.length&&(r.vmodels=t)};var Sr=[],xr=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,Tr=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,Nr=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/ig,Cr={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/ig,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/ig,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/ig},kr=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Lr=/([^\#-~| |!])/g,Or=avalon.filters={uppercase:function(e){return e.toUpperCase()},lowercase:function(e){return e.toLowerCase()},truncate:function(e,t,n){return t=t||30,n=typeof n=="string"?n:"...",e.length>t?e.slice(0,t-n.length)+n:String(e)},$filter:function(e){for(var t=1,n=arguments.length;t<n;t++){var r=arguments[t],i=avalon.filters[r[0]];if(typeof i=="function"){var s=[e].concat(r.slice(1));e=i.apply(null,s)}}return e},camelize:jt,sanitize:function(e){return e.replace(xr,"").replace(Nr,function(e,t){var n=e.toLowerCase().match(/<(\w+)\s/);if(n){var r=Cr[n[1]];r&&(e=e.replace(r,function(e,t,n){var r=n.charAt(0);return t+"="+r+"javascript:void(0)"+r}))}return e.replace(Tr," ").replace(/\s+/g," ")})},escape:function(e){return String(e).replace(/&/g,"&amp;").replace(kr,function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return"&#"+((t-55296)*1024+(n-56320)+65536)+";"}).replace(Lr,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}};return new function(){function t(){return/iPad|iPhone|iPod/i.test(e)&&!window.MSStream?"backdropFilter"in document.documentElement.style?9:window.indexedDB?8:window.SpeechSynthesisUtterance?7:window.webkitAudioContext?6:window.matchMedia?5:!!window.history&&"pushState"in window.history?4:3:NaN}function o(e,t){return t&&s.forEach(function(n){e[n]=t[n]}),e}var e=navigator.userAgent.toLowerCase(),n=e.indexOf("android")>0,r=t(),i=avalon.gestureHooks={pointers:{},start:function(e,t){for(var n=0;n<e.changedTouches.length;n++){var r=e.changedTouches[n],s={startTouch:o({},r),startTime:Date.now(),status:"tapping",element:e.target};i.pointers[r.identifier]=s,t(s,r)}},move:function(e,t){for(var n=0;n<e.changedTouches.length;n++){var r=e.changedTouches[n],s=i.pointers[r.identifier];if(!s)return;"lastTouch"in s||(s.lastTouch=s.startTouch,s.lastTime=s.startTime,s.deltaX=s.deltaY=s.duration=s.distance=0);var u=Date.now()-s.lastTime;if(u>0){var a=70;u>a&&(u=a),s.duration+u>a&&(s.duration=a-u),s.duration+=u,s.lastTouch=o({},r),s.lastTime=Date.now(),s.deltaX=r.clientX-s.startTouch.clientX,s.deltaY=r.clientY-s.startTouch.clientY;var f=s.deltaX*s.deltaX,l=s.deltaY*s.deltaY;s.distance=Math.sqrt(f+l),s.isVertical=f<l,t(s,r)}}},end:function(e,t){for(var n=0;n<e.changedTouches.length;n++){var r=e.changedTouches[n],s=r.identifier,o=i.pointers[s];if(!o)continue;t(o,r),delete i.pointers[s]}},fire:function(e,t,n){if(e){var r=document.createEvent("Events");r.initEvent(t,!0,!0),avalon.mix(r,n),e.dispatchEvent(r)}},add:function(e,t){function n(e){t.touchmove(e)}function r(e){t.touchend(e),document.removeEventListener("touchmove",n),document.removeEventListener("touchend",r),document.removeEventListener("touchcancel",i)}function i(e){t.touchcancel(e),document.removeEventListener("touchmove",n),document.removeEventListener("touchend",r),document.removeEventListener("touchcancel",i)}t.events.forEach(function(s){avalon.eventHooks[s]={fn:function(s,o){return s["touch-"+e]||(s["touch-"+e]="1",s.addEventListener("touchstart",function(e){t.touchstart(e),document.addEventListener("touchmove",n),document.addEventListener("touchend",r),document.addEventListener("touchcancel",i)})),o}}})}},s=["screenX","screenY","clientX","clientY","pageX","pageY"],u=!!navigator.pointerEnabled||!!navigator.msPointerEnabled;u&&(b.style.msTouchAction=b.style.touchAction="none");var a={events:["tap"],touchBoundary:10,tapDelay:200,needClick:function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(r&&e.type==="file"||e.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return!1},needFocus:function(e){switch(e.nodeName.toLowerCase()){case"textarea":case"select":return!0;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return!1}},focus:function(e){var t,n=e.type;r&&e.setSelectionRange&&n.indexOf("date")!==0&&n!=="time"&&n!=="month"?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},findControl:function(e){return e.control!==undefined?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},fixTarget:function(e){return e.nodeType===3?e.parentNode:window.SVGElementInstance&&e instanceof SVGElementInstance?e.correspondingUseElement:e},updateScrollParent:function(e){var t=e.tapScrollParent;if(!t||!t.contains(e)){var n=e;do{if(n.scrollHeight>n.offsetHeight){t=n,e.tapScrollParent=n;break}n=n.parentElement}while(n)}t&&(t.lastScrollTop=t.scrollTop)},touchHasMoved:function(e){var t=e.changedTouches[0],n=a.touchBoundary;return Math.abs(t.pageX-a.touchStartX)>n||Math.abs(t.pageY-a.touchStartY)>n},findType:function(e){return n&&e.tagName.toLowerCase()==="select"?"mousedown":"click"},sendClick:function(e,t){i.fire(e,"tap",{touchEvent:t});var n,r;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),r=t.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(a.findType(e),!0,!0,window,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null),n.touchEvent=t,e.dispatchEvent(n)},touchstart:function(e){if(e.targetTouches.length!==1)return!0;var t=a.fixTarget(e.target),n=e.targetTouches[0];if(r){var i=window.getSelection();if(i.rangeCount&&!i.isCollapsed)return!0;var s=n.identifier;if(s&&isFinite(a.lastTouchIdentifier)&&a.lastTouchIdentifier===s)return e.preventDefault(),!1;a.lastTouchIdentifier=s,a.updateScrollParent(t)}a.status="tapping",a.startTime=Date.now(),a.element=t,a.pageX=n.pageX,a.pageY=n.pageY,a.startTime-a.lastTime<a.tapDelay&&e.preventDefault()},touchmove:function(e){if(a.status!=="tapping")return!0;if(a.element!==a.fixTarget(e.target)||a.touchHasMoved(e))a.status=a.element=0},touchend:function(e){var t=a.element,s=Date.now();if(!t||s-a.startTime>a.tapDelay)return!0;a.lastTime=s;var o=a.startTime;a.status=a.startTime=0,targetTagName=t.tagName.toLowerCase();if(targetTagName==="label"){i.fire(t,"tap",{touchEvent:e});var u=a.findControl(t);u&&(a.focus(t),t=u)}else if(a.needFocus(t))return s-o>100||r&&window.top!==window&&targetTagName==="input"?(a.element=0,!1):(a.focus(t),n&&a.sendClick(t,e),!1);if(r){var f=t.tapScrollParent;if(f&&f.lastScrollTop!==f.scrollTop)return!0}a.needClick(t)||(e.preventDefault(),a.sendClick(t,e))},touchcancel:function(){a.startTime=a.element=0}};i.add("tap",a);var f={events:["longtap","doubletap"],cancelPress:function(e){clearTimeout(e.pressingHandler),e.pressingHandler=null},touchstart:function(e){i.start(e,function(t,n){t.pressingHandler=setTimeout(function(){t.status==="tapping"&&i.fire(e.target,"longtap",{touch:n,touchEvent:e}),f.cancelPress(t)},500),e.changedTouches.length!==1&&(t.status=0)})},touchmove:function(e){i.move(e,function(e){e.distance>10&&e.pressingHandler&&(f.cancelPress(e),e.status==="tapping"&&(e.status="panning"))})},touchend:function(e){i.end(e,function(t,n){f.cancelPress(t),t.status==="tapping"&&(t.lastTime=Date.now(),f.lastTap&&t.lastTime-f.lastTap.lastTime<300&&i.fire(t.element,"doubletap",{touch:n,touchEvent:e}),f.lastTap=t)})},touchcancel:function(e){i.end(e,function(e){f.cancelPress(e)})}};i.add("press",f);var l={events:["swipe","swipeleft","swiperight","swipeup","swipedown"],getAngle:function(e,t){var n=Math.atan2(t,e),r=Math.round(n*180/Math.PI);return r<0?360-Math.abs(r):r},getDirection:function(e,t){var n=l.getAngle(e,t);return n<=45&&n>=0?"left":n<=360&&n>=315?"left":n>=135&&n<=225?"right":n>45&&n<135?"down":"up"},touchstart:function(e){i.start(e,x)},touchmove:function(e){i.move(e,x)},touchend:function(e){if(e.changedTouches.length!==1)return;i.end(e,function(t,n){var r=t.distance>30&&t.distance/t.duration>.65;if(r){var s={deltaX:t.deltaX,deltaY:t.deltaY,touch:n,touchEvent:e,direction:l.getDirection(t.deltaX,t.deltaY),isVertical:t.isVertical},o=t.element;i.fire(o,"swipe",s),i.fire(o,"swipe"+s.direction,s)}})}};l.touchcancel=l.touchend,i.add("swipe",l)},avalon});